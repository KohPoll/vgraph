<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />

    <title>国际汉语教材编写指南</title>

    <link rel="stylesheet" href="css/main.css" />

    <!-- base lib -->
    <script src="js/lib/jquery.js"></script>

    <!--[if lte IE 8]>
    <script src="js/lib/excanvas.min.js"></script>
    <![endif]-->

    <!-- flot lib -->
    <script src="js/lib/flot/jquery.flot.js"></script>
    <script src="js/lib/flot/jquery.flot.selection.js"></script>
</head>
<body>
    <div id="container">
        <h1 class="title">字-词-语法点-全文词频-全文字频-统计图</h1>

        <div class="control" id="J_control">
            <p>
				<label title=""><input type="radio" name="type" value="full-word" checked="checked" />词频(全文)</label>
                <!--<label title=""><input type="radio" name="type" value="full-character" />字频(全文)统计</label>-->
                <label title=""><input type="radio" name="type" value="noncharacteristic-word" />无词性词(总表)</label>
                <label title=""><input type="radio" name="type" value="noncharacteristic-word-mainland" />无词性词(大陆)</label>
                <label title=""><input type="radio" name="type" value="noncharacteristic-word-HMT" />无词性词(港澳台)</label>
                <label title=""><input type="radio" name="type" value="noncharacteristic-word-JK" />无词性词(日韩)</label>
                <label title=""><input type="radio" name="type" value="noncharacteristic-word-other" />无词性词(其他)</label>
            </p>
            <p>
              	<label title=""><input type="radio" name="level" value="0" checked="checked" />全图</label>
               	<label title=""><input type="radio" name="level" value="1" />甲级细节图</label>
              	<label title=""><input type="radio" name="level" value="2" />乙级细节图</label>
                <label title=""><input type="radio" name="level" value="3" />丙级细节图</label>
                <label title=""><input type="radio" name="level" value="4" />丁级细节图</label>
            </p>
        </div>

        <div id="graph">
            <!--<div class="preload"></div>-->
            <div id="placeHolder"></div>
            <br/><br/><br/><br/><br/><br/>
        </div>

       <div id="side">
            <div id="dataContainer"></div>
        </div>

        <br style="clear:both;" />
    </div>

    <!--<div class="preload"></div>-->

    <script src="js/graph.js"></script>

<script>
$(document).ready(function() {

    var control = $('#J_control'),
        graphCache = {}, graphLevelMapperCache = {},
        drawGraph = function() {
            var checkedItem, 
                graph, graphType, graphLevel, 
                baseUrl = 'data/poll-data.php', reqUrl;

            checkedItem = $(':checked');
            graphType = checkedItem[0].value;
            graphLevel = checkedItem[1].value;

            //console.log(graphType+','+graphLevel);
            graph = graphCache[graphType];
            if (graph) {
                graph.rerenderPlot();
                graph.levelMapper[graphLevel]();
            } else {
                reqUrl = baseUrl + '?type=' + graphType;
                $.getJSON(reqUrl, function(resp) {
                    graph = new Graph('#placeHolder', '#dataContainer', graphType);
                    graph.render(resp);
                    graph.levelMapper[graphLevel]();

                    graphCache[graphType] = graph;
                });
            }
        };

    control.bind('click', function(evt) {
        var target = evt.target;
        if (target.tagName === 'INPUT') {
            drawGraph();
        }
    });
    drawGraph();

});
</script>
</body>
</html>
