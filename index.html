<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />

    <title>统计图表-可视化-首页</title>

    <link rel="stylesheet" href="css/main.css" />

    <!-- base lib -->
    <script src="js/lib/jquery.js"></script>

    <!--[if lte IE 8]>
    <script src="js/lib/excanvas.min.js"></script>
    <![endif]-->

    <!-- flot lib -->
    <script src="js/lib/flot/jquery.flot.js"></script>
    <script src="js/lib/flot/jquery.flot.selection.js"></script>
</head>
<body>
    <div id="container">
        <h1 class="title">统计图表</h1>

        <div class="control" id="J_control">
            <p>
                <input type="radio" name="type" value="full-word" />词频(全文)统计
                <input type="radio" name="type" value="full-character" checked="checked" />字频(全文)统计
            </p>
            <p>
                <input type="radio" name="level" value="0" checked="checked" />全图
                <input type="radio" name="level" value="1" />甲级细节图
                <input type="radio" name="level" value="2" />乙级细节图
                <input type="radio" name="level" value="3" />丙级细节图
                <input type="radio" name="level" value="4" />丁级细节图
            </p>
        </div>

        <div id="graph">
            <!--<div class="preload"></div>-->
            <div id="placeHolder"></div>
            <br/><br/><br/><br/><br/><br/>
        </div>

        <div id="side">
            <div id="dataContainer">
                <h2>临近的数据信息</h2>
            </div>
        </div>

        <br style="clear:both;" />
    </div>

    <div class="preload"></div>

    <script src="js/graph.js"></script>

<script>
$(document).ready(function() {

    var control = $('#J_control'),
        dataContainer = $('#dataContainer'),
        graph = null;

    control.bind('click', function(evt) {
        var target = evt.target,
            checkedItem, type, level;

        if (target.tagName === 'INPUT') {
            checkedItem = $(':checked');

            type = checkedItem[0].value;
            level = parseInt(checkedItem[1].value, 10);

            //drawGraph(graph);
            $.getJSON('data/poll-data.php?type=' + type, function(resp) {
                if (!graph) {
                    graph = new Graph({
                        placeHolder: '#placeHolder',
                        skin: { labelSuffix: '字({count})' },
                        data: { value: resp }
                    });
                } else {
                    graph.update({ 
                        data: { value: resp }
                    });
                }

                graph.renderByLevel(level);
            });
        }
    });
});
</script>
</body>
</html>
