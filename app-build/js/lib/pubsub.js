define(function(){var b={};b.version="1.0.1";var d={};var a=-1;var c=function(f,h,e){if(!d.hasOwnProperty(f)){return false}var g=function(){var o=d[f];var k=function(i){return function(){throw i}};for(var m=0,l=o.length;m<l;m++){try{o[m].func(f,h)}catch(n){setTimeout(k(n),0)}}};if(e===true){g()}else{setTimeout(g,0)}return true};b.publish=function(e,f){return c(e,f,false)};b.publishSync=function(e,f){return c(e,f,true)};b.subscribe=function(g,f){if(!d.hasOwnProperty(g)){d[g]=[]}var e=(++a).toString();d[g].push({token:e,func:f});return e};b.unsubscribe=function(h){for(var e in d){if(d.hasOwnProperty(e)){for(var g=0,f=d[e].length;g<f;g++){if(d[e][g].token===h){d[e].splice(g,1);return h}}}}return false};return b});